<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - EarnZY</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i">

</head>

<body>
    <nav class="navbar navbar-light navbar-expand-lg fixed-top bg-white clean-navbar">
        <div class="container"><a class="navbar-brand logo" href="#">EarnZY</a><button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse"
                id="navcol-1">
                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item" role="presentation"><a class="nav-link active" href="payment-page.html">Payment</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href="index.html">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="page payment-page">
        <section class="clean-block payment-form dark">
            <div class="container">
                <div class="block-heading">
                    <h2 class="text-info">Dashboard</h2>
                    <p class="welcomeName"></p>
                </div>
                <form>
                    <div class="products">
                        <h3 class="title">Balances</h3>
                        <div class="item"><span class="price">200</span>


                            <p class="item-name">Points</p>
                            <p class="item-description">Can only spend points more than 1000</p>
                        </div>
                        <!-- <div class="item"><span class="price">$120</span>
                            <p class="item-name">Product 2</p>
                            <p class="item-description">Lorem ipsum dolor sit amet</p>
                        </div> -->
                        <div class="total"><span>Total</span><span class="price">R200</span></div>
                    </div>
                    <!-- SPEN POINTS -->
                    <div class="card-details">
                        <h3 class="title">Spend Points</h3>
                        <div class="form-row">
                            <!-- <div class="col-sm-7">
                                <div class="form-group"><label for="card-holder">Card Holder</label><input class="form-control" type="text" placeholder="Card Holder"></div>
                            </div>
                            <div class="col-sm-5">
                                <div class="form-group"><label>Expiration date</label>
                                    <div class="input-group expiration-date"><input class="form-control" type="text" placeholder="MM"><input class="form-control" type="text" placeholder="YY"></div>
                                </div>
                            </div>
                            <div class="col-sm-8">
                                <div class="form-group"><label for="card-number">Card Number</label><input class="form-control" type="text" placeholder="Card Number" id="card-number"></div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group"><label for="cvc">CVC</label><input class="form-control" type="text" placeholder="CVC" id="cvc"></div>
                            </div> -->
                            <div class="col-sm-12">
                                   <h3>Purchase Airtime</h3>

                                </div><br><br>
                                <div class="col-sm-12">
                                    <select class="btn btn-primary btn-block" id='list'>
                                        <option value="MTN">MTN</option>
                                        <option value="Vodacom">Vodacom</option>
                                        <option value="CellC">CellC</option>
                                    </select>
                                     </div>
                                <div class="col-sm-8" style="margin-top: 10px"><input id="amount" placeholder="enter amount" type="number" value=""></div>
                                <div class="col-sm-8" style="margin-top: 10px"><input id="account" placeholder="enter account" type="number" value=""></div>
                                
                            <div class="col-sm-12">
                                <div class="form-group"><button id='proceed' class="btn btn-primary btn-block" type="button">Proceed</button></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </section>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/theme.js"></script>
    <script>
    var list = document.querySelector('#list');
    var amounts= document.querySelector('#amount');
    var account = document.querySelector('#account')
    var proceed = document.querySelector('#proceed');
    var aut ='token '+localStorage.getItem('token');
       console.log(aut)
    function selectedvalue(){
    var amountValue = (amounts.value)*0.01;
    var currencyValue = "ZAR";
        var queryObj = {
        amount:amountValue,
        currency: currencyValue
        }
        console.log(JSON.stringify(queryObj))
        $.ajax({
        url: 'https://api.rehive.com/3/transactions/credit/', 
        type: 'POST', // <<- the method that we using
        data: JSON.stringify(queryObj), // <<- JSON of our request obj
        headers: {
        "Content-Type":'application/json',
        "Authorization":aut
    },
        fail: function(xhr, textStatus, errorThrown) {
    
          console.log(errorThrown, textStatus, xhr); //  <<- log any http errors to the console
            return false;  
        }
      }).done(function(results) {
        
       console.log(results);
       
        });      
    };

    function sendToflash(){
    var amountValue = amounts.value;
    var accontValue = account.value;
    var listValue =  list.value;
    var flashObj = {
        [listValue]:amountValue,
        AccNr:accontValue
        }
        console.log(JSON.stringify(flashObj))
        $.ajax({
        url: 'http://localhost:5000/account', 
        type: 'POST', // <<- the method that we using
        data: JSON.stringify(flashObj), // <<- JSON of our request obj
        headers: {
        "Content-Type":'application/json',
        "Authorization":aut
    },
        fail: function(xhr, textStatus, errorThrown) {
    
          console.log(errorThrown, textStatus, xhr); //  <<- log any http errors to the console
            return false;  
        }
      }).done(function(results) {
        
       console.log(results);
       
        });      
    };

   proceed.addEventListener('click', function(){
       selectedvalue();
       sendToflash()})

    </script>
    
</body>

</html>